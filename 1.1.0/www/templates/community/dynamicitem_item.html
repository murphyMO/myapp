<ion-view view-title="动态" ng-controller="DynamicItemCtrl">
	<ion-header-bar align-title="center" class="bar-light">
		<div class="item-input-inset" ng-click="myGoBack()">
			<span>
				<i class="ion-chevron-left color-blue"></i>
			</span>
		</div>
		 <h1 class="title fontsize-16 color-black">动态</h1>
	</ion-header-bar>

	<ion-content class="has-header">
		<ion-refresher pulling-text="下拉刷新" on-refresh="dynamicDoRefresh()"></ion-refresher>
		<div class="m-t-10 seviveBox" ng-repeat="dynamicItem in dynamicList" >
			<div class="item item-avatar b-none">
				<img ng-src="{{commonPath.route_path}}{{commonPath.photo_path}}{{dynamicItem.one_inch_photo_url}}" err-src="img/icon_emptyPeron.png" ng-click="change(dynamicItem)" ng-if="dynamicItem.article_type_status==1">
				<img ng-src="img/icon_emptyPeron.png" ng-if="dynamicItem.article_type_status==2">
				<div class="xkd-activeInfoCon">
					<h3 ng-if="dynamicItem.article_type_status==1" style="text-overflow: ellipsis;white-space: nowrap;course:hand;width: 72%">
						<strong class="xkd-recommend-list-title heroBlue">{{dynamicItem.article_data_user_name}}</strong>
					</h3>
					<h3 ng-if="dynamicItem.article_type_status==2" style="text-overflow: ellipsis;white-space: nowrap;course:hand;width: 72%">
						<strong class="xkd-recommend-list-title heroBlue">匿名</strong>
					</h3>
					<small class="xkd-subTit gray" ng-if="dynamicItem.article_type_status==1" ui-sref="commsg({com_id:dynamicItem.article_com_id})">{{dynamicItem.com_name}}</small>
					<small class="xkd-subTit gray" ng-if="dynamicItem.article_type_status==2">匿名公司</small>
				</div>
			</div>
			<div class="item item-avatar b-t-none autoHeight padding-t-5 b-none">
				<p class="m-b-10 heroBlack" style="white-space: pre-line;" compile-template ng-bind-html="dynamicItem.article_content"></p>
				<div ng-if="dynamicItem.dynamicImgItems">
					<ion-gallery ion-gallery-items="dynamicItem.dynamicImgItems" ion-gallery-item-edit="false"></ion-gallery>
				</div>
			</div>
			<div class="item item-avatar b-t-none padding-t-10 padding-b-10 b-l-none b-r-none ">
				<div class="xkd-recommend-list-content pull-left m-b-10">
					<i class="ion-ios-clock-outline m-r-5"></i>{{dynamicItem.article_cre_time}}
				</div>
				<div class="xkd-coumcit-gray-con pull-right fontsize-15">
					<a ng-click="likeYou(1,dynamicItem,dynamicItem.is_like)" class="m-r-5">
						<span ng-show="dynamicItem.is_like==0"><i class="ion-android-favorite-outline"></i> 赞</span>
						<span class="heroBlue" ng-show="dynamicItem.is_like==1"><i class="ion-heart"></i>&nbsp;赞</span>
					</a>
					<a ng-click="replayShow(1,dynamicItem,-1,1)" class="m-l-10 m-r-5"><i class="ion-android-textsms"></i> 评论</a>
				</div>
				<div class="bg-dark padding-l-10 padding-r-10" style="clear:both;border-radius:5px;"
					 ng-show="dynamicItem.like.length>0||dynamicItem.message.length>0">
					<div style="position: relative">
						<div style="width:0; height:0; border-width:8px; border-style:solid; border-color:transparent transparent #edf1f2 transparent; font-size:0; line-height:0;position: absolute;bottom: -1px;left: 10px">
						</div>
					</div>
					<div>
						<div class="padding-5" ng-class="{'b-b':dynamicItem.message.length>0}"
							 ng-show="dynamicItem.like.length>0" style="white-space:normal;">
							<i class="ion-android-favorite-outline heroBlue fontsize-12"></i>
							<a class="positive fontsize-12" ng-repeat="like in dynamicItem.like">{{like.like_user_name}}&nbsp;&nbsp;</a>
						</div>
						<div class="padding-5" style="white-space: normal;word-break: break-all;" ng-show="dynamicItem.message.length>0">
							<div on-hold="onHold(message.message_user_name,message.message_id)" ng-repeat="message in dynamicItem.message"
								 ng-click="replayShow(2,dynamicItem,$index,1)">
								<a class="positive fontsize-12">{{message.message_user_name}}</a><span class="fontsize-12" ng-if="message.message_parent_user_name"> 回复 </span><a class="positive fontsize-12">{{message.message_parent_user_name}}</a><span>:</span>
								<span class="fontsize-12">{{message.message_content}}</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</ion-content>
	<div style="bottom:0">
		<ion-footer-bar class="bar bar-footer item-input-inset" ng-show="replay_show" style="position:fixed;" keyboard-attach>
			<label class="item-input-wrapper">
				<input type="search" ng-blur="replayBlur()" auto-focus-when="replay_show" ng-model="re.message_content" placeholder="说点什么呢？">
			</label>
			<button class="button button-small button-calm" ng-click='sendReplay()'>
				发送
			</button>
		</ion-footer-bar>
	</div>
</ion-view>
