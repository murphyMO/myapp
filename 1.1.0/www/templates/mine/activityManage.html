<ion-view view-title="活动" ng-controller="ActivityManageController" on-swipe-right="activityOnSwipeRight()" >

	
	<ion-content class="has-header bg-dark">
		<ion-refresher pulling-text="下拉刷新" on-refresh="activityDoRefresh()"></ion-refresher>
		<div class="card" style="margin-bottom:8px;" ng-repeat="activityItem in activityList">
			<div class="item item-avatar" style="border-bottom-width:0px">
				<img ui-sref="personalmsg({user_id:activityItem.cre_user_id,com_id:activityItem.cre_com_id,from:'tab.communityactivity'})" ng-src="{{commonPath.route_path}}{{commonPath.photo_path}}{{activityItem.one_inch_photo_url}}" err-src="img/icon_empty_img.png">

				<h2>{{activityItem.title}}</h2>

				<small class="calm" ui-sref="commsg({com_id:activityItem.cre_com_id,from:'tab.communityactivity'})">{{activityItem.com_name}}</small>
				<span class="badge badge-assertive">活动</span>
			</div>
			<!--<div class="item item-avatar b-t-none">-->
			<div class="item b-t-none active-detail">
				<p class="m-b-10" style="white-space: normal;">{{activityItem.content}}</p>

				<div>
					<ion-gallery ion-gallery-items="activityItem.activityImgItems" ion-gallery-item-edit="false"></ion-gallery>
				</div>


				<div ui-sref="postMaterialDetail({id:activityItem.com_article_material_id,from:'tab.communityactivity'})" class="item m-t-10" style="background: #f2f2f2;padding: 3px;border: none;" ng-if="activityItem.com_article_material_id">
					<span class="pull-left" style="display: inline-block;width: 30px;height: 30px;">
						<img width="100%" ng-src="{{activityItem.material_thumb}}" err-src="img/icon_empty_img.png">
					</span>
					<a class="pull-left m-l-10">{{activityItem.material_abstract}}</a>
				</div>
				<div class="m-t-10">
					<div class="fontsize-12">
            <i class="ion-ios-timer-outline"></i> {{activityItem.start_time}}&nbsp;—
            <i class="ion-ios-clock"></i> {{activityItem.end_time}}
          </div>
					<!--<div class="fontsize-12"><i class="ion-ios-clock"></i> {{activityItem.end_time}}</div>-->
					<div class="fontsize-12"><i class="ion-location"></i> {{activityItem.address}}</div>
				</div>
			</div>
			<div class="item  b-t-none" style="padding:15px 23px">
				<div class="pull-left" style="width:100%">
					<a class="button button-small" style="border-left:none" ng-click="enroll(activityItem)" >
						<span ng-show="activityItem.is_enroll==0 && activityItem.enroll_show == true" ng-class="{calm:activityItem.is_enroll == 0}">参与</span>
						<span ng-show="activityItem.is_enroll==1 && activityItem.enroll_show == true">取消参与</span>
						<span ng-show="activityItem.enroll_show == false">报名失效</span>
					</a>
					<a class="button button-small" ng-click="likeYou(3,activityItem,activityItem.is_like)">
						<span ng-show="activityItem.is_like==0"><i class="ion-heart"></i> 赞</span>
						<span ng-show="activityItem.is_like==1"><i class="ion-heart assertive"></i> 取消赞</span>
					</a>
					<a class="button button-small" ng-click="replayShow(1,activityItem,-1,3)"><i class="ion-chatbox-working"></i> 评论</a>
				</div>
				<div class="m-t-sm bg-light active-apply" style=" clear:both;border-radius:5px" ng-show="activityItem.like.length>0||activityItem.service_message_info.length>0">
					<div style="position: relative;">
						<div style="width:0; height:0; border-width:8px; border-style:solid; border-color:transparent transparent #edf1f2 transparent; font-size:0; line-height:0;position: absolute;bottom: -1px;left: 10px">
						</div>
					</div>
					<div>
						<div class="padding-5" ng-class="{'b-b':activityItem.service_message_info.length>0}" ng-show="activityItem.like.length>0">
							<i class="ion-heart fontsize-12"></i>
							<a class="positive fontsize-12" ng-repeat="like in activityItem.like">{{like.like_user_name}}&nbsp;&nbsp;</a>
						</div>
						<div class="padding-5" ng-show="activityItem.service_message_info.length>0">
							<div on-hold="onHold(message.repley_user_name,message.message_id)" ng-repeat="message in activityItem.service_message_info" ng-click="replayShow(2,activityItem,$index,3)">
								<a class="positive fontsize-12">{{message.repley_user_name}}</a><span class="fontsize-12" ng-if="message.parent_repley_user_name"> 回复 </span><a class="positive fontsize-12">{{message.parent_repley_user_name}}</a><span>:</span>
								<span class="fontsize-12">{{message.message_content}}</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<ion-infinite-scroll ng-if="!activityIsEmptyData" on-infinite="getActivityList()" distance="1%"></ion-infinite-scroll>
		<div class="text-center" ng-show="activityIsOverLoad">
			<img style="width: 100%" src="img/icon_empty_img.png"/>
		</div>
	</ion-content>
	<div style="bottom:0">
		<ion-footer-bar keyboard-attach class="bar bar-footer item-input-inset has-tabs" ng-show="replay_show" style="position:fixed;">
			<label class="item-input-wrapper">
				<input type="search" autofocus="autofocus" ng-model="re.message_content" placeholder="说点什么呢？">
			</label>
			<button class="button button-small button-calm" ng-click='sendReplay()'>
				发送
			</button>
		</ion-footer-bar>
	</div>
	<i ng-click="scrollTop()" class="ion-arrow-up-b back-top rounded-500 text-center" style="position:absolute;right:30px;bottom:80px;font-size:30px;"></i>
</ion-view>
